library(tidyverse)
library(fixest)
library(DRDID)
library(did)
options(readr.show_progress = FALSE, readr.show_col_types = FALSE)
setFixest_etable(markdown = FALSE)
df <- read_csv("data/tva.csv")
head(df)
View(df)
m_d1_y1960 <- df %>% filter(year == 1960 & tva == 1) %>% pull(ln_agriculture) %>% mean()
m_d1_y1960
means |>
group_by(tva, year) |>
summarise(mean = mean(ln_agriculture))
df |>
group_by(tva, year) |>
summarise(mean = mean(ln_agriculture))
df |>
group_by(tva, year) |>
summarise(mean = mean(ln_agriculture)) |>
pivot_wider(names_from = year, values_from = mean) |>
mutate(diff = `1960` - `1940`)
m_d1_y1960 <- df %>% filter(year == 1960 & tva == 1) %>% pull(ln_agriculture) %>% mean()
df |>
group_by(tva, year) |>
summarise(mean = mean(ln_agriculture)) |>
pivot_wider(names_from = year, values_from = mean) |>
mutate(diff_60_40 = `1960` - `1940`)
df |>
group_by(tva, year) |>
summarise(mean = mean(ln_agriculture)) |>
pivot_wider(names_from = year, values_from = mean) |>
mutate(diff_60_40 = `1960` - `1940`) |>
janitor::adorn_totals()
dd <- means |>
select(tva, diff_60_40) |>
spread(tva, diff_60_40) |>
mutate(diff = `1` - `0`) |>
pull(diff)
m_d1_y1960 <- df %>% filter(year == 1960 & tva == 1) %>% pull(ln_agriculture) %>% mean()
df |>
group_by(tva, year) |>
summarise(mean = mean(ln_agriculture)) |>
pivot_wider(names_from = year, values_from = mean) |>
mutate(diff_60_40 = `1960` - `1940`) -> means
dd <- means |>
select(tva, diff_60_40) |>
spread(tva, diff_60_40) |>
mutate(diff = `1` - `0`) |>
pull(diff)
View(means)
dd <- means |>
select(tva, diff_60_40) |>
spread(tva, diff_60_40)
means |>
select(tva, diff_60_40) |>
spread(tva, diff_60_40)
means |>
select(tva, diff_60_40) |>
spread(tva, diff_60_40) |>
mutate(diff = `1` - `0`)
did_2by2 <- df_2by2 |>
lm(ln_agriculture ~ tva + post + tva:post, data = .) |>
summary() |>
coef() |>
pull(1)
df_2by2 <- df |>
filter(year %in% c(1940, 1960))
did_2by2 <- df_2by2 |>
lm(ln_agriculture ~ tva + post + tva:post, data = .) |>
summary() |>
coef() |>
pull(1)
df_2by2 <- df |>
filter(year %in% c(1940, 1960))
did_2by2 <- df_2by2 |>
lm(ln_agriculture ~ tva + post + tva:post, data = .) |>
summary() |>
coef() |>
pull(1)
df_2by2 <- df |>
filter(year %in% c(1940, 1960))
did_2by2 <- df_2by2 |>
lm(ln_agriculture ~ tva + post + tva:post, data = .) |>
summary() |>
coef() |>
pull(1)
df_2by2 <- df |>
filter(year %in% c(1940, 1960))
did_2by2 <- df_2by2 |>
lm(ln_agriculture ~ tva + post + tva:post) |>
summary() |>
coef() |>
pull(1)
df_2by2 <- df |>
filter(year %in% c(1940, 1960))
did_2by2 <- df_2by2 |>
lm(formula = ln_agriculture ~ tva + post + tva:post) |>
summary() |>
coef() |>
pull(1)
df_2by2 <- df |>
filter(year %in% c(1940, 1960))
did_2by2 <- df_2by2 |>
lm(formula = ln_agriculture ~ tva + post + tva:post) |>
summary() |>
coef()
df_2by2 <- df |>
filter(year %in% c(1940, 1960))
did_2by2 <- df_2by2 |>
lm(formula = ln_agriculture ~ tva + post + tva:post) |>
summary()
did_2by2
df_2by2 |>
feols(ln_agriculture ~ tva + post | county_code + year) |>
summary()
did_2by2_feols <- df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~ i(tva * post) | county_code + year,
cluseter = ~ county_code) |>
summary()
did_2by2_feols <- df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~ i(tva * post) | county_code + year,
cluster = ~ county_code) |>
summary()
df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~ i(tva * post) | county_code + year,
cluster = ~ county_code) |>
summary()
did_2by2_feols <- df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~
i(tva * post) |  year,
cluster = ~ county_code) |>
summary()
df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~
i(tva * post) |  year,
cluster = ~ county_code) |>
summary()
df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~
i(tva * post) ,
cluster = ~ county_code) |>
summary()
did_2by2_feols_fe <- df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~
i(tva * post) | county_code + year,
cluster = ~ county_code) |>
summary()
did_2by2_feols_fe <- df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~
i(tva * post) | county_code + year,
cluster = ~ county_code) |>
summary()
did_2by2
did_2by2_feols_fe <- df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~
i(tva * post) | county_code + year,
cluster = ~ county_code) |>
summary()
did_2by2_feols_fe
df_2by2 |>
feols(c(ln_agriculture, ln_manufacturing) ~
i(tva * post) | county_code,
cluster = ~ county_code) |>
summary()
es_agriculture <- df |>
feols(ln_agriculture ~
i(year* tva, ref = c(0, 1940)) | county_code + year,
cluster = ~ county_code)
iplot(es_agriculture, title = "Event Study: Agriculture")
es_agriculture <- df |>
mutate(rel_year= ifelse(tva ==0, 1940, year)) |>
feols(ln_agriculture ~
i(year* tva, ref = c(0, 1940)) | county_code + year,
cluster = ~ county_code)
iplot(es_agriculture, title = "Event Study: Agriculture")
es_agriculture <- df |>
mutate(rel_year= ifelse(tva ==0, 190, year)) |>
feols(ln_agriculture ~
i(rel_year, ref = c(1940, 1900)) | county_code + year,
cluster = ~ county_code)
iplot(es_agriculture, title = "Event Study: Agriculture")
es_agriculture <- df |>
mutate(rel_year= ifelse(tva ==0, 190, year)) |>
feols(ln_agriculture ~
i(rel_year, ref = c(1940, 1900)) | county_code + year,
cluster = ~ county_code)
iplot(es_agriculture
es_agriculture <- df |>
mutate(rel_year= ifelse(tva ==0, 190, year)) |>
feols(ln_agriculture ~
i(rel_year, ref = c(1940, 1900)) | county_code + year,
cluster = ~ county_code)
iplot(es_agriculture)
es_agriculture <- df |>
mutate(rel_year= ifelse(tva ==0, 1900, year)) |>
feols(ln_agriculture ~
i(rel_year, ref = c(1940, 1900)) | county_code + year,
cluster = ~ county_code)
iplot(es_agriculture)
es_manufacturing <- df |>
mutate(rel_year= ifelse(tva ==0, 1940, year)) |>
feols(ln_manufacturing ~
i(rel_year, ref = c(1940)) | county_code + year,
cluster = ~ county_code)
iplot(es_agriculture)
es_manufacturing <- df |>
mutate(rel_year= ifelse(tva ==0, 1940, year)) |>
feols(ln_manufacturing ~
i(rel_year, ref = c(1940)) | county_code + year,
cluster = ~ county_code)
iplot(es_manufacturing)
broom:tidy(es_manufacturing)
broom::tidy(es_manufacturing)
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
#  bind_rows(tible())
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point() +
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
#  bind_rows(tible())
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point()
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
bind_rows(tible(rel_year = 1940, estimate = 0, std.error = 0)) |>
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point()
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
bind_rows(tible(rel_year = 1940, estimate = 0)) |>
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point()
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
bind_rows(tibble(rel_year = 1940, estimate = 0)) |>
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point()
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
bind_rows(tibble(rel_year = 1940, estimate = 0)) |>
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point() +
theme_bw()
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
bind_rows(tibble(rel_year = 1940, estimate = 0)) |>
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point() +
theme_bw()+
geom_abline(intercept = coef(pre_trand_line[1]),
slope = coef(pre_trand_line[2]),
color = 'red')
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
bind_rows(tibble(rel_year = 1940, estimate = 0)) |>
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point() +
theme_bw()+
geom_abline(intercept = coef(pre_trend_line[1]),
slope = coef(pre_trend_line[2]),
color = 'red')
View(df)
library(tidyverse)
library(fixest)
library(DRDID)
library(did)
options(readr.show_progress = FALSE, readr.show_col_types = FALSE)
setFixest_etable(markdown = FALSE)
df <- read_csv("data/tva.csv")
broom::tidy(es_manufacturing) |>
mutate(rel_year = as.numeric(str_replace(term, 'rel_year::', ''))) |>
bind_rows(tibble(rel_year = 1940, estimate = 0)) |>
ggplot(aes(x = rel_year, y = estimate)) +
geom_errorbar(aes(ymin = estimate - 1.96*std.error, ymax = estimate + 1.96*std.error)) +
geom_point() +
theme_bw()+
geom_abline(intercept = coef(pre_trend_line[1]),
slope = coef(pre_trend_line[2]),
color = 'red')
